ext {
	swagger_annotations_version = "2.2.2"
	jackson_version = "2.13.3"
	jersey_version = "2.36"
}

dependencies {
//	api 'org.springframework.boot:spring-boot-starter-json:+'

//	Need to include libraries for generated code to work
//	implementation "javax.annotation:javax.annotation-api:1.3.2"
//	implementation "io.swagger.core.v3:swagger-annotations:$swagger_annotations_version"
	implementation "io.swagger:swagger-annotations:1.6.6"

	implementation "com.google.code.findbugs:jsr305:3.0.2" // TODO: is there a less-abandoned jar to use?

	implementation "org.glassfish.jersey.core:jersey-client:$jersey_version"
	implementation "org.glassfish.jersey.media:jersey-media-multipart:$jersey_version"
	implementation "org.glassfish.jersey.media:jersey-media-json-jackson:$jersey_version"

	implementation "com.fasterxml.jackson.core:jackson-core:$jackson_version"
	implementation "com.fasterxml.jackson.core:jackson-annotations:$jackson_version"
	implementation "com.fasterxml.jackson.core:jackson-databind:$jackson_version"
	implementation "com.fasterxml.jackson.datatype:jackson-datatype-jsr310:$jackson_version"

	implementation "org.openapitools:jackson-databind-nullable:0.2.3"


//	implementation "com.brsanthu:migbase64:2.2"
//	implementation "org.glassfish.jersey.inject:jersey-hk2:$jersey_version"
//	implementation "org.glassfish.jersey.connectors:jersey-jdk-connector:$jersey_version"
}

openApiGenerate {
	inputSpec = "$rootDir//service/src/main/resources/static/swagger/openapi-docs.yaml".toString()
	outputDir = "$buildDir/generated".toString()
	generatorName = 'java'
	library = 'jersey2'
	configOptions = [
		dateLibrary: "java11"
	]
	invokerPackage = "${artifactGroup}.client".toString()
	modelPackage = "${artifactGroup}.model".toString()
	apiPackage = "${artifactGroup}.api".toString()
	ignoreFileOverride = '${projectDir}/.swagger-codegen-ignore'
	// we may want to generate tests or doc later ...
	generateModelTests = false
	generateModelDocumentation = false
	generateApiTests = false
	generateApiDocumentation = false
}

idea.module.generatedSourceDirs = [file("${openApiGenerate.outputDir.get()}/src/main")]
sourceSets.main.java.srcDir files("${openApiGenerate.outputDir.get()}/src/main")
compileJava.dependsOn tasks.getByName('openApiGenerate')
sourcesJar.dependsOn tasks.getByName('openApiGenerate')
